"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6221],{4718:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>d});var t=n(3309);const s={},i=t.createContext(s);function l(e){const r=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(i.Provider,{value:r},e.children)}},7381:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"infrastructure/azure/azure-iam","title":"Managing Azure IAM Roles and Permissions","description":"Overview","source":"@site/docs/infrastructure/azure/azure-iam.md","sourceDirName":"infrastructure/azure","slug":"/infrastructure/azure/azure-iam","permalink":"/dx/pr-preview/pr-518/docs/infrastructure/azure/azure-iam","draft":false,"unlisted":false,"editUrl":"https://github.com/pagopa/dx/tree/main/website/docs/infrastructure/azure/azure-iam.md","tags":[],"version":"current","frontMatter":{"sidebar_label":"Managing Azure IAM Roles and Permissions"},"sidebar":"tutorialSidebar","previous":{"title":"Archiving Data for Decommissioned Projects","permalink":"/dx/pr-preview/pr-518/docs/infrastructure/azure/archive-data"},"next":{"title":"Implementing Azure IAM Across Subscriptions using Terraform","permalink":"/dx/pr-preview/pr-518/docs/infrastructure/azure/iam-cross-subscription"}}');var s=n(3881),i=n(4718);const l={sidebar_label:"Managing Azure IAM Roles and Permissions"},d="Managing Azure IAM Roles and Permissions",c={},a=[{value:"Overview",id:"overview",level:2},{value:"Roles and Permissions",id:"roles-and-permissions",level:2},{value:"Subscription-Level Access",id:"subscription-level-access",level:3},{value:"Admin Group",id:"admin-group",level:4},{value:"Developer Group",id:"developer-group",level:4},{value:"External Group",id:"external-group",level:4},{value:"Resource Group-Level Access",id:"resource-group-level-access",level:3},{value:"Team-Specific Resource Groups",id:"team-specific-resource-groups",level:4},{value:"Admin Group",id:"admin-group-1",level:5},{value:"Developer Group",id:"developer-group-1",level:5},{value:"External Group",id:"external-group-1",level:5},{value:"Shared Resources-Level Access",id:"shared-resources-level-access",level:4},{value:"Role-Based Access Matrix",id:"role-based-access-matrix",level:2},{value:"Roles explanation",id:"roles-explanation",level:3},{value:"Code Examples (How-To) and Common Troubleshooting",id:"code-examples-how-to-and-common-troubleshooting",level:2},{value:"How to label a resource group as team-owned",id:"how-to-label-a-resource-group-as-team-owned",level:3},{value:"Azure Resources",id:"azure-resources",level:3},{value:"Notes",id:"notes",level:4},{value:"Azure APIM",id:"azure-apim",level:3},{value:"Azure Cache for Redis",id:"azure-cache-for-redis",level:3},{value:"Team-owned Redis",id:"team-owned-redis",level:4},{value:"Shared Redis",id:"shared-redis",level:4},{value:"Azure Cosmos DB",id:"azure-cosmos-db",level:3},{value:"Azure Event Hub",id:"azure-event-hub",level:3},{value:"Team-owned Event Hub",id:"team-owned-event-hub",level:4},{value:"Shared Event Hub",id:"shared-event-hub",level:4},{value:"Azure Key Vault",id:"azure-key-vault",level:3},{value:"Team-owned Key Vault",id:"team-owned-key-vault",level:4},{value:"Shared Key Vault",id:"shared-key-vault",level:4},{value:"Azure NAT Gateway",id:"azure-nat-gateway",level:3},{value:"Azure Notification Hub",id:"azure-notification-hub",level:3},{value:"Team-owned Notification Hub",id:"team-owned-notification-hub",level:4},{value:"Shared Notification Hub",id:"shared-notification-hub",level:4},{value:"Azure Storage Account",id:"azure-storage-account",level:3},{value:"Blob",id:"blob",level:4},{value:"Team-owned Storage Account",id:"team-owned-storage-account",level:5},{value:"Shared Storage Account",id:"shared-storage-account",level:5},{value:"Terraform Storage Account",id:"terraform-storage-account",level:5},{value:"Queue",id:"queue",level:4},{value:"Team-owned Storage Account",id:"team-owned-storage-account-1",level:5},{value:"Shared Storage Account",id:"shared-storage-account-1",level:5},{value:"Terraform Storage Account",id:"terraform-storage-account-1",level:5},{value:"Table",id:"table",level:4},{value:"Team-owned Storage Account",id:"team-owned-storage-account-2",level:5},{value:"Shared Storage Account",id:"shared-storage-account-2",level:5},{value:"Terraform Storage Account",id:"terraform-storage-account-2",level:5},{value:"Best Practices",id:"best-practices",level:2},{value:"Role Usage Guidelines",id:"role-usage-guidelines",level:3},{value:"Security Considerations",id:"security-considerations",level:3}];function o(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components},{Details:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"managing-azure-iam-roles-and-permissions",children:"Managing Azure IAM Roles and Permissions"})}),"\n",(0,s.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(r.p,{children:"Understanding Azure Identity and Access Management (IAM) roles and permissions\nis crucial for developer teams to securely and efficiently manage access to\ncloud resources while maintaining the least privilege principles."}),"\n",(0,s.jsx)(r.p,{children:"In order to ensure a clear separation of concerns and resource ownership, as DX\nteam, we have defined a set of guidelines and best practices for managing IAM\nroles and permissions in Azure."}),"\n",(0,s.jsx)(r.h2,{id:"roles-and-permissions",children:"Roles and Permissions"}),"\n",(0,s.jsx)(r.p,{children:"We propose a role-based access control (RBAC) model that leverages Azure Entra\nID groups to manage access to Azure resources. Each team will have three Entra\nID security groups:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Admins (domain experts)"}),"\n",(0,s.jsx)(r.li,{children:"Developers (regular team members)"}),"\n",(0,s.jsx)(r.li,{children:"Externals (contractors)"}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["This segmentation allows for appropriate access levels based on role\nresponsibilities and trust levels. Each team is responsible and autonomous on\nhow to split members among these groups by making PRs on\n",(0,s.jsx)(r.a,{href:"https://github.com/pagopa/eng-azure-authorization/tree/main/src/azure-subscriptions/subscriptions",children:"eng-azure-authorization"}),"\nrepository."]}),"\n",(0,s.jsx)(r.p,{children:"This section outlines the IAM configuration for each Entra ID group."}),"\n",(0,s.jsx)(r.h3,{id:"subscription-level-access",children:"Subscription-Level Access"}),"\n",(0,s.jsx)(r.h4,{id:"admin-group",children:"Admin Group"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Contributor"})," role on the subscription: can view and manage all resources"]}),"\n",(0,s.jsx)(r.li,{children:"Can assist in emergency situations and manage cross-team resources"}),"\n"]}),"\n",(0,s.jsx)(r.h4,{id:"developer-group",children:"Developer Group"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Reader"})," role on the subscription: can view all resources but cannot modify\nthem"]}),"\n",(0,s.jsx)(r.li,{children:"Provides an overview of the broader infrastructure context"}),"\n"]}),"\n",(0,s.jsx)(r.h4,{id:"external-group",children:"External Group"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Reader"})," role on the subscription (same as Developer group)"]}),"\n",(0,s.jsx)(r.li,{children:"Can understand the system architecture while maintaining security"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"resource-group-level-access",children:"Resource Group-Level Access"}),"\n",(0,s.jsx)(r.h4,{id:"team-specific-resource-groups",children:"Team-Specific Resource Groups"}),"\n",(0,s.jsx)(r.p,{children:"While subscriptions may be shared across teams, resource groups are owned and\nmanaged by a single team."}),"\n",(0,s.jsx)(r.h5,{id:"admin-group-1",children:"Admin Group"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Owner"})," role: full control over all resources within the group"]}),"\n",(0,s.jsx)(r.li,{children:"Can manage IAM assignments within the group"}),"\n",(0,s.jsx)(r.li,{children:"Can manage resource locks"}),"\n",(0,s.jsxs)(r.li,{children:["In Key Vaults using RBAC:","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Key Vault Data Access Administrator"})," role: can manage secrets, keys and\ncertificates"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Key Vault Administrator"})," role: can manage resource properties"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h5,{id:"developer-group-1",children:"Developer Group"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Contributor"})," role: can create and manage resources"]}),"\n",(0,s.jsx)(r.li,{children:"Cannot modify IAM assignments"}),"\n",(0,s.jsx)(r.li,{children:"Cannot modify resource locks"}),"\n",(0,s.jsxs)(r.li,{children:["In Key Vaults using RBAC:","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Key Vault Secrets Officer"})," role: can manage secrets"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h5,{id:"external-group-1",children:"External Group"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"Reader"})," (inherited) role: can view resources and configurations"]}),"\n",(0,s.jsx)(r.li,{children:"No modification privileges"}),"\n"]}),"\n",(0,s.jsx)(r.h4,{id:"shared-resources-level-access",children:"Shared Resources-Level Access"}),"\n",(0,s.jsx)(r.p,{children:"Some resources are inherently shared across teams due to their nature or\narchitectural decisions. These include (but are not limited to):"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Application Gateways"}),"\n",(0,s.jsx)(r.li,{children:"API Management"}),"\n",(0,s.jsx)(r.li,{children:"Public and Private DNS Zones"}),"\n",(0,s.jsx)(r.li,{children:"Private Endpoints"}),"\n",(0,s.jsx)(r.li,{children:"Other product-specific resources"}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["For shared resources, teams must request role assignments through Pull Requests\nto the repository where they are defined (generally ",(0,s.jsx)(r.code,{children:"<product-name>-infra"}),").\nThis process is useful to control access and management of critical resources\nwith big radius impact."]}),"\n",(0,s.jsx)(r.h2,{id:"role-based-access-matrix",children:"Role-Based Access Matrix"}),"\n",(0,s.jsxs)(r.p,{children:["The following roles are set up automatically by the Terraform module\n",(0,s.jsx)(r.code,{children:"azure_github_environment_bootstrap"}),". Its usage is strong advised for mono\nrepositories. The first view is cleaner and easier to read, recommended for\ndevelopers."]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Simplified view"}),(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{style:{textAlign:"center"}}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product Subscription"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product Private Endpoints"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product Private DNS Zone"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product NAT Gateway"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product APIM"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Team Resource Groups"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Opex Resource Group"})})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Entra ID Adm"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer - Lock manager - IAM manager"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Entra ID Devs"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer - No access to Certificate and Keys"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Entra ID Ext"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"****"}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Infra CI"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"List secrets"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Infra CD"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader - IAM Manager"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer - IAM Manager - Manage resource locks"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader - IAM Manager"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID App CD"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Opex CI"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Opex CD"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Writer"})]})]})]})]}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(r.p,{children:"This view is instead recommended for cloud operators."}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Detailed view"}),(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{style:{textAlign:"center"}}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product Subscription"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product Private Endpoints"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product Private DNS Zone"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product NAT Gateway"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Product APIM"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Team Resource Groups"})}),(0,s.jsx)(r.th,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Opex Resource Group"})})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Entra ID Adm"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Contributor"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Contributor)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Contributor)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Contributor)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Contributor)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Owner - Key Vault Data Access Administrator - Key Vault Administrator"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Contributor)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Entra ID Devs"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Contributor - Key Vault Secrets Officer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"Entra ID Ext"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"****"}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}}),(0,s.jsx)(r.td,{style:{textAlign:"center"}})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Infra CI"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"PagoPA API Management Service List Secrets"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Key Vault Secrets User - Key Vault Certificate User - Key Vault Crypto User - Storage Blob Data Reader - Storage Queue Data Reader - Storage Table Data Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Infra CD"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader - Role Based Access Control Administrator"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Network Contributor"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Private DNS Zone Contributor"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Network Contributor"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"API Management Service Contributor"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Contributor - Key Vault Secrets Officer - Key Vault Certificates Officer - Key Vault Crypto Officer"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Role Based Access Control Administrator)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID App CD"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Contributor"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Opex CI"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader - Reader and Data Access"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:(0,s.jsx)(r.strong,{children:"ID Opex CD"})}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Reader"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"(inherited Reader - Reader and Data Access)"}),(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"Monitoring Contributor - PagoPA Opex Dashboards Contributor"})]})]})]})]}),"\n",(0,s.jsx)(r.h3,{id:"roles-explanation",children:"Roles explanation"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Role"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Reader"})}),(0,s.jsx)(r.td,{children:"Resource control plane read-only access"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Reader and Data Access"})}),(0,s.jsx)(r.td,{children:"Resource data plane read access. Allows writing on Storage Account using keys as authentication system"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"PagoPA IaC Reader"})}),(0,s.jsx)(r.td,{children:"List keys and credentials for IaC access"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"DocumentDB Account Contributor"})}),(0,s.jsx)(r.td,{children:"CosmosDB control plane access"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Key Vault Data Access Administrator"})}),(0,s.jsx)(r.td,{children:"Manage access to Azure Key Vault"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Key Vault Administrator"})}),(0,s.jsx)(r.td,{children:"Includes data plane operations on a key vault and all objects in it, including certificates, keys, and secrets"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Key Vault Secrets Officer"})}),(0,s.jsx)(r.td,{children:"Perform any action on the secrets of a key vault, except managing permissions"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Role Based Access Control Administrator"})}),(0,s.jsx)(r.td,{children:"Manage access to Azure resources by assigning roles using Azure RBAC"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"User Access Administrator"})}),(0,s.jsx)(r.td,{children:"Lets you manage user access to Azure resources, including locks"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Network Contributor"})}),(0,s.jsx)(r.td,{children:"Lets you manage networks, but not access to them"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Private DNS Zone Contributor"})}),(0,s.jsx)(r.td,{children:"Lets you manage private DNS zone resources, but not the virtual networks they are linked to"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"API Management Service Contributor"})}),(0,s.jsx)(r.td,{children:"Can manage the service and the APIs"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Storage Blob Data Contributor"})}),(0,s.jsx)(r.td,{children:"Read, write, and delete Azure Storage containers and blobs"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Storage Queue Data Contributor"})}),(0,s.jsx)(r.td,{children:"Read, write, and delete Azure Storage queues and queue messages"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Storage Table Data Contributor"})}),(0,s.jsx)(r.td,{children:"Allows for read, write, and delete access to Azure Storage tables and entities"})]})]})]}),"\n",(0,s.jsx)(r.h2,{id:"code-examples-how-to-and-common-troubleshooting",children:"Code Examples (How-To) and Common Troubleshooting"}),"\n",(0,s.jsx)(r.h3,{id:"how-to-label-a-resource-group-as-team-owned",children:"How to label a resource group as team-owned"}),"\n",(0,s.jsxs)(r.p,{children:["Create the resource group in ",(0,s.jsx)(r.code,{children:"Repository"})," Terraform configuration of your mono\nrepository and pass its resource id to the ",(0,s.jsx)(r.code,{children:"azure_github_environment_bootstrap"}),"\nmodule via the ",(0,s.jsx)(r.code,{children:"additional_resource_group_ids"})," variable. All roles will be\nautomatically applied."]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'  resource "azurerm_resource_group" "domain_itn_01" {\n    name     = "name"\n    location = "location"\n    tags     = local.tags\n  }\n\n  module "repo" {\n    source  = "pagopa-dx/azure-github-environment-bootstrap/azurerm"\n    version = "~>1.0"\n\n    TBD = [\n      azurerm_resource_group.domain_itn_01.id\n    ]\n  }\n'})})]}),"\n",(0,s.jsx)(r.h3,{id:"azure-resources",children:"Azure Resources"}),"\n",(0,s.jsx)(r.p,{children:"Understand IAM and assigning the right role in the right way could be difficult.\nSo, this section shows most common scenarios developers may face."}),"\n",(0,s.jsx)(r.h4,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(r.p,{children:["The label ",(0,s.jsx)(r.code,{children:"set by the module"})," means that the role is already given by the DX\nmodule ",(0,s.jsx)(r.code,{children:"azure_github_environment_bootstrap"})," to Entra ID groups. ",(0,s.jsx)(r.strong,{children:"Applications\nstill need a role assignment"})," (possibly with the narrowest scope)."]}),"\n",(0,s.jsx)(r.p,{children:"Code samples should be set next to the resource definition, unless otherwise\nspecified. The repository can be found in resource tags on Azure Portal."}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"Writer"})," role includes ",(0,s.jsx)(r.code,{children:"Reader"}),", unless otherwise specified."]}),"\n",(0,s.jsx)(r.h3,{id:"azure-apim",children:"Azure APIM"}),"\n",(0,s.jsxs)(r.p,{children:["If you get an error about roles while operating on APIM, please add the\n",(0,s.jsx)(r.code,{children:"apim_id"})," optional variable to the ",(0,s.jsx)(r.code,{children:"azure_github_environment_bootstrap"})," by\nspecifying the APIM instance resource Id."]}),"\n",(0,s.jsx)(r.h3,{id:"azure-cache-for-redis",children:"Azure Cache for Redis"}),"\n",(0,s.jsx)(r.h4,{id:"team-owned-redis",children:"Team-owned Redis"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h4,{id:"shared-redis",children:"Shared Redis"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'resource "azurerm_role_assignment" "" {\n  scope                = <redis-id>\n  role_definition_name = "Contributor"\n  principal_id         = <who-needs-access>\n}\n'})})]}),"\n",(0,s.jsx)(r.h3,{id:"azure-cosmos-db",children:"Azure Cosmos DB"}),"\n",(0,s.jsx)(r.p,{children:"In both scenarios, it is mandatory to manually set IAM roles. This approach is\nrecommended as keys are not secure."}),"\n",(0,s.jsx)(r.p,{children:"It is also recommended to set roles at container level rather than Cosmos DB\nAccount, especially for applications and shared Accounts."}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'module "" {\n  source  = "pagopa-dx/azure-role-assignments/azurerm"\n  version = "~>0.0"\n\n  principal_id = <who-needs-access>\n\n  cosmos = [\n    {\n      account_name = <st-target-name>\n      resource_group_name  = <st-target-rg-name>\n      role                 = "reader" # or writer\n    }\n  ]\n}\n'})}),(0,s.jsxs)(r.p,{children:["Optionally set the database and container via optional variables ",(0,s.jsx)(r.code,{children:"database"})," and\n",(0,s.jsx)(r.code,{children:"collections"}),"."]})]}),"\n",(0,s.jsx)(r.h3,{id:"azure-event-hub",children:"Azure Event Hub"}),"\n",(0,s.jsx)(r.h4,{id:"team-owned-event-hub",children:"Team-owned Event Hub"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h4,{id:"shared-event-hub",children:"Shared Event Hub"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'module "" {\n  source  = "pagopa-dx/azure-role-assignments/azurerm"\n  version = "~>0.0"\n\n  principal_id = <who-needs-access>\n\n  event_hub = [\n    {\n      namespace_name = <st-target-name>\n      resource_group_name  = <st-target-rg-name>\n      role                 = "reader" # or writer\n    }\n  ]\n}\n'})}),(0,s.jsxs)(r.p,{children:["Optionally set the Event Hubs via ",(0,s.jsx)(r.code,{children:"event_hub_names"})," property."]})]}),"\n",(0,s.jsx)(r.h3,{id:"azure-key-vault",children:"Azure Key Vault"}),"\n",(0,s.jsx)(r.h4,{id:"team-owned-key-vault",children:"Team-owned Key Vault"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module if using RBAC access model (recommended)."}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Enabling RBAC access model to Key Vault"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'resource "azurerm_key_vault" "" {\n  name                = "name"\n  location            = "location"\n  resource_group_name = "resource-group"\n\n  enable_rbac_authorization = true\n}\n'})})]}),"\n",(0,s.jsx)(r.p,{children:"Otherwise via Access Policies:"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Manage Key Vault Access Policies"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'module "" {\n  source  = "pagopa-dx/azure-role-assignments/azurerm"\n  version = "~>0.0"\n\n  principal_id = <who-needs-access>\n\n  key_vault = [\n    {\n      secrets      = "writer" # or writer or owner\n      certificates = "writer" # or writer or owner\n      keys         = "writer" # or writer or owner\n    }\n  ]\n}\n'})})]}),"\n",(0,s.jsx)(r.h4,{id:"shared-key-vault",children:"Shared Key Vault"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'module "" {\n  source  = "pagopa-dx/azure-role-assignments/azurerm"\n  version = "~>0.0"\n\n  principal_id = <who-needs-access>\n\n  key_vault = [\n    {\n      secrets      = "writer" # or writer or owner\n      certificates = "writer" # or writer or owner\n      keys         = "writer" # or writer or owner\n    }\n  ]\n}\n'})})]}),"\n",(0,s.jsx)(r.h3,{id:"azure-nat-gateway",children:"Azure NAT Gateway"}),"\n",(0,s.jsxs)(r.p,{children:["If you get an error about roles while associating a NAT Gateway to an\nAppService/Function App, please add the ",(0,s.jsx)(r.code,{children:"nat_gateway_resource_group_id"})," optional\nvariable to the ",(0,s.jsx)(r.code,{children:"azure_github_environment_bootstrap"})," by specifying the NAT\nGateways' resource group Id."]}),"\n",(0,s.jsx)(r.h3,{id:"azure-notification-hub",children:"Azure Notification Hub"}),"\n",(0,s.jsx)(r.h4,{id:"team-owned-notification-hub",children:"Team-owned Notification Hub"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h4,{id:"shared-notification-hub",children:"Shared Notification Hub"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Enable Terraform state access via Entra ID"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'resource "azurerm_role_assignment" "" {\n  scope                = <notification-hub-namespace-id>\n  role_definition_name = "Contributor"\n  principal_id         = <who-needs-access>\n}\n'})})]}),"\n",(0,s.jsx)(r.h3,{id:"azure-storage-account",children:"Azure Storage Account"}),"\n",(0,s.jsx)(r.p,{children:"It is recommended to use Entra ID authentication to access Storage Accounts,\ninstead of using keys. In fact, key-based access ignores IAM roles and can be\nused by anyone without further authentication."}),"\n",(0,s.jsx)(r.p,{children:"To set Entra ID authentication as default and disabling key access, set the\nproperties TBD of the Storage Account DX module."}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Enable Terraform state access via Entra ID"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'backend "azurerm" {\n  ...\n  `use_azuread_auth` = true\n}\n'})})]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Enable Storage Account access via Entra ID"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'provider "azurerm" {\n  features {}\n  storage_use_azuread = true\n}\n\n'})})]}),"\n",(0,s.jsx)(r.h4,{id:"blob",children:"Blob"}),"\n",(0,s.jsx)(r.h5,{id:"team-owned-storage-account",children:"Team-owned Storage Account"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h5,{id:"shared-storage-account",children:"Shared Storage Account"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'module "" {\n  source  = "pagopa-dx/azure-role-assignments/azurerm"\n  version = "~>0.0"\n\n  principal_id = <who-needs-access>\n\n  storage_blob = [\n    {\n      storage_account_name = <st-target-name>\n      resource_group_name  = <st-target-rg-name>\n      role                 = "reader" # or writer\n    }\n  ]\n}\n'})}),(0,s.jsxs)(r.p,{children:["Optionally set the container name via ",(0,s.jsx)(r.code,{children:"container_name"})," property."]})]}),"\n",(0,s.jsx)(r.h5,{id:"terraform-storage-account",children:"Terraform Storage Account"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h4,{id:"queue",children:"Queue"}),"\n",(0,s.jsx)(r.h5,{id:"team-owned-storage-account-1",children:"Team-owned Storage Account"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h5,{id:"shared-storage-account-1",children:"Shared Storage Account"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'module "" {\n  source  = "pagopa-dx/azure-role-assignments/azurerm"\n  version = "~>0.0"\n\n  principal_id = <who-needs-access>\n\n  storage_queue = [\n    {\n      storage_account_name = <st-target-name>\n      resource_group_name  = <st-target-rg-name>\n      role                 = "reader" # or writer\n    }\n  ]\n}\n'})}),(0,s.jsxs)(r.p,{children:["Optionally set the container name via ",(0,s.jsx)(r.code,{children:"queue_name"})," property."]})]}),"\n",(0,s.jsx)(r.h5,{id:"terraform-storage-account-1",children:"Terraform Storage Account"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h4,{id:"table",children:"Table"}),"\n",(0,s.jsx)(r.h5,{id:"team-owned-storage-account-2",children:"Team-owned Storage Account"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h5,{id:"shared-storage-account-2",children:"Shared Storage Account"}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-hcl",children:'module "" {\n  source  = "pagopa-dx/azure-role-assignments/azurerm"\n  version = "~>0.0"\n\n  principal_id = <who-needs-access>\n\n  storage_table = [\n    {\n      storage_account_name = <st-target-name>\n      resource_group_name  = <st-target-rg-name>\n      role                 = "reader" # or writer\n    }\n  ]\n}\n\nOptionally set the table name via `table_name` property.\n\n'})})]}),"\n",(0,s.jsx)(r.h5,{id:"terraform-storage-account-2",children:"Terraform Storage Account"}),"\n",(0,s.jsx)(r.p,{children:"Set by the module"}),"\n",(0,s.jsx)(r.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(r.h3,{id:"role-usage-guidelines",children:"Role Usage Guidelines"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Follow least-privilege principle"}),"\n",(0,s.jsx)(r.li,{children:"Add a brief description in the proper field of the role assignment object when\navailable"}),"\n",(0,s.jsx)(r.li,{children:"Use admin privileges only for critical operations"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Avoid connection strings; use managed identities where possible"}),"\n",(0,s.jsx)(r.li,{children:"Remove unused role assignments"}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);