"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8359],{1352:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"pipelines/cdn-deploy","title":"CDN Code Deploy","description":"The","source":"@site/docs/pipelines/cdn-deploy.md","sourceDirName":"pipelines","slug":"/pipelines/cdn-deploy","permalink":"/dx/docs/pipelines/cdn-deploy","draft":false,"unlisted":false,"editUrl":"https://github.com/pagopa/dx/tree/main/website/docs/pipelines/cdn-deploy.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Deploying Assets to CDN"},"sidebar":"tutorialSidebar","previous":{"title":"Configuring Azure Login for GitHub Actions","permalink":"/dx/docs/pipelines/azure-login"},"next":{"title":"Code Review","permalink":"/dx/docs/pipelines/code-review"}}');var s=o(3881),t=o(4718);const r={sidebar_position:1,sidebar_label:"Deploying Assets to CDN"},c="CDN Code Deploy",a={},l=[{value:"How It Works",id:"how-it-works",level:2},{value:"Usage",id:"usage",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"cdn-code-deploy",children:"CDN Code Deploy"})}),"\n",(0,s.jsxs)(n.p,{children:["The\n",(0,s.jsx)(n.a,{href:"https://github.com/pagopa/dx/tree/main/.github/actions/cdn-code-deploy",children:"CDN Code Deploy action"}),"\nis a utility that simplifies the deployment of assets to a Content Delivery\nNetwork (CDN). It also provides the ability to selectively purge specific paths\nor perform a full purge of the CDN cache."]}),"\n",(0,s.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsx)(n.p,{children:"The action performs the following steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Synchronizes the specified directory with the Azure Blob Storage container."}),"\n",(0,s.jsxs)(n.li,{children:["Optionally purges specific paths in the CDN cache if ",(0,s.jsx)(n.code,{children:"selective_purge_paths"}),"\nis provided."]}),"\n",(0,s.jsx)(n.li,{children:"If no specific paths are provided, purges the entire CDN cache."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.p,{children:"To use the CDN Code Deploy action, create a workflow file in your repository.\nBelow is an example configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'name: CDN Code Deploy\n\non:\n  workflow_dispatch:\n\njobs:\n  cdn_deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n\n      # ...other steps, such as Azure login, can be added here...\n\n      - name: Deploy to CDN\n        uses: pagopa/dx/.github/actions/cdn-code-deploy@main\n        with:\n          storage_account_name: "your-storage-account-name"\n          blob_container_name: "your-blob-container-name"\n          resource_group_name: "your-resource-group-name"\n          profile_name: "your-cdn-profile-name"\n          endpoint_name: "your-cdn-endpoint-name"\n          selective_purge_paths: "./path/file1 ./path/file2"\n          sync_dir_name: "dist"\n          working_directory: "."\n'})}),"\n",(0,s.jsx)(n.p,{children:"When implementing this action in your repository:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Adjust paths"})," - Ensure ",(0,s.jsx)(n.code,{children:"sync_dir_name"})," and ",(0,s.jsx)(n.code,{children:"working_directory"})," match your\nproject structure."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Selective purge"})," - Use ",(0,s.jsx)(n.code,{children:"selective_purge_paths"})," to optimize cache purging\nfor specific files or directories."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Permissions"})," - Ensure the Azure CLI is authenticated and has the necessary\npermissions to access the storage account and CDN."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},4718:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>c});var i=o(3309);const s={},t=i.createContext(s);function r(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);