<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-infrastructure/azure/azure-iam" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Managing Azure IAM Roles and Permissions | DX</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pagopa.github.io/dx/pr-preview/pr-518/img/pagopa-logo.png"><meta data-rh="true" name="twitter:image" content="https://pagopa.github.io/dx/pr-preview/pr-518/img/pagopa-logo.png"><meta data-rh="true" property="og:url" content="https://pagopa.github.io/dx/pr-preview/pr-518/docs/infrastructure/azure/azure-iam"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Managing Azure IAM Roles and Permissions | DX"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/dx/pr-preview/pr-518/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pagopa.github.io/dx/pr-preview/pr-518/docs/infrastructure/azure/azure-iam"><link data-rh="true" rel="alternate" href="https://pagopa.github.io/dx/pr-preview/pr-518/docs/infrastructure/azure/azure-iam" hreflang="en"><link data-rh="true" rel="alternate" href="https://pagopa.github.io/dx/pr-preview/pr-518/docs/infrastructure/azure/azure-iam" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/dx/pr-preview/pr-518/blog/rss.xml" title="DX RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/dx/pr-preview/pr-518/blog/atom.xml" title="DX Atom Feed"><link rel="stylesheet" href="/dx/pr-preview/pr-518/assets/css/styles.89df9373.css">
<script src="/dx/pr-preview/pr-518/assets/js/runtime~main.ad3a0724.js" defer="defer"></script>
<script src="/dx/pr-preview/pr-518/assets/js/main.b57e5e8f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_zRNq" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dx/pr-preview/pr-518/"><div class="navbar__logo"><img src="/dx/pr-preview/pr-518/img/pagopa-logo.png" alt="DX Logo" class="themedComponent_jECA themedComponent--light_Vqq4"><img src="/dx/pr-preview/pr-518/img/pagopa-logo.png" alt="DX Logo" class="themedComponent_jECA themedComponent--dark_QX9o"></div><b class="navbar__title text--truncate">DX</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pagopa/dx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_SVY_"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_fqNg colorModeToggle_Ps8L"><button class="clean-btn toggleButton_N5dx toggleButtonDisabled_RVMO" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_bCLk"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_gaJe"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_VVrK"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_O0Ef"><div class="docsWrapper_leh4"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_QxQO" type="button"></button><div class="docRoot_KioV"><aside class="theme-doc-sidebar-container docSidebarContainer_EHVu"><div class="sidebarViewport_gRYp"><div class="sidebar_gJbf"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_jiHa"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dx/pr-preview/pr-518/docs/">Developer Experience Initiative</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dx/pr-preview/pr-518/docs/getting-started/">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dx/pr-preview/pr-518/docs/articles/">Articles</a><button aria-label="Expand sidebar category &#x27;Articles&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dx/pr-preview/pr-518/docs/conventions/">Conventions</a><button aria-label="Expand sidebar category &#x27;Conventions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/dx/pr-preview/pr-518/docs/infrastructure/">Infrastructure</a><button aria-label="Collapse sidebar category &#x27;Infrastructure&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/using-terraform-registry-modules">Using DX Terraform Modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/using-terraform-registry-provider">Using DX Azure Terraform Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/contributing-to-dx-provider">Contributing to DX Azure Provider</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/contributing-to-dx-terraform-modules/">Contributing to DX Terraform Modules</a><button aria-label="Expand sidebar category &#x27;Contributing to DX Terraform Modules&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/">Azure</a><button aria-label="Collapse sidebar category &#x27;Azure&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/azure-policies">Creating and Managing Azure Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/appservice-hidden-appsettings">Using Secrets in AppService Environment Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/appservice-plan-dns-resolution">Verifying Online Service Reachability from an App Service Plan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/archive-data">Archiving Data for Decommissioned Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/azure-iam">Managing Azure IAM Roles and Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/iam-cross-subscription">Implementing Azure IAM Across Subscriptions using Terraform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/peps-cross-subscription">Connecting Resources Across Azure Subscription via Private Endpoints</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/policy-catalog/">DX Policy Rules Catalog</a><button aria-label="Expand sidebar category &#x27;DX Policy Rules Catalog&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dx/pr-preview/pr-518/docs/pipelines/">Pipelines</a><button aria-label="Expand sidebar category &#x27;Pipelines&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_KToB"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_SC0d"><div class="docItemContainer_iHos"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Sy1s" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/dx/pr-preview/pr-518/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon__noQ"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/dx/pr-preview/pr-518/docs/infrastructure/"><span itemprop="name">Infrastructure</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/"><span itemprop="name">Azure</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Managing Azure IAM Roles and Permissions</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_hfZj theme-doc-toc-mobile tocMobile_PU7Q"><button type="button" class="clean-btn tocCollapsibleButton_VVfl">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Managing Azure IAM Roles and Permissions</h1></header>
<h2 class="anchor anchorWithStickyNavbar_YRFy" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>Understanding Azure Identity and Access Management (IAM) roles and permissions
is crucial for developer teams to securely and efficiently manage access to
cloud resources while maintaining the least privilege principles.</p>
<p>In order to ensure a clear separation of concerns and resource ownership, as DX
team, we have defined a set of guidelines and best practices for managing IAM
roles and permissions in Azure.</p>
<h2 class="anchor anchorWithStickyNavbar_YRFy" id="roles-and-permissions">Roles and Permissions<a href="#roles-and-permissions" class="hash-link" aria-label="Direct link to Roles and Permissions" title="Direct link to Roles and Permissions">​</a></h2>
<p>We propose a role-based access control (RBAC) model that leverages Azure Entra
ID groups to manage access to Azure resources. Each team will have three Entra
ID security groups:</p>
<ul>
<li>Admins (domain experts)</li>
<li>Developers (regular team members)</li>
<li>Externals (contractors)</li>
</ul>
<p>This segmentation allows for appropriate access levels based on role
responsibilities and trust levels. Each team is responsible and autonomous on
how to split members among these groups by making PRs on
<a href="https://github.com/pagopa/eng-azure-authorization/tree/main/src/azure-subscriptions/subscriptions" target="_blank" rel="noopener noreferrer">eng-azure-authorization</a>
repository.</p>
<p>This section outlines the IAM configuration for each Entra ID group.</p>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="subscription-level-access">Subscription-Level Access<a href="#subscription-level-access" class="hash-link" aria-label="Direct link to Subscription-Level Access" title="Direct link to Subscription-Level Access">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="admin-group">Admin Group<a href="#admin-group" class="hash-link" aria-label="Direct link to Admin Group" title="Direct link to Admin Group">​</a></h4>
<ul>
<li><code>Contributor</code> role on the subscription: can view and manage all resources</li>
<li>Can assist in emergency situations and manage cross-team resources</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="developer-group">Developer Group<a href="#developer-group" class="hash-link" aria-label="Direct link to Developer Group" title="Direct link to Developer Group">​</a></h4>
<ul>
<li><code>Reader</code> role on the subscription: can view all resources but cannot modify
them</li>
<li>Provides an overview of the broader infrastructure context</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="external-group">External Group<a href="#external-group" class="hash-link" aria-label="Direct link to External Group" title="Direct link to External Group">​</a></h4>
<ul>
<li><code>Reader</code> role on the subscription (same as Developer group)</li>
<li>Can understand the system architecture while maintaining security</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="resource-group-level-access">Resource Group-Level Access<a href="#resource-group-level-access" class="hash-link" aria-label="Direct link to Resource Group-Level Access" title="Direct link to Resource Group-Level Access">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="team-specific-resource-groups">Team-Specific Resource Groups<a href="#team-specific-resource-groups" class="hash-link" aria-label="Direct link to Team-Specific Resource Groups" title="Direct link to Team-Specific Resource Groups">​</a></h4>
<p>While subscriptions may be shared across teams, resource groups are owned and
managed by a single team.</p>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="admin-group-1">Admin Group<a href="#admin-group-1" class="hash-link" aria-label="Direct link to Admin Group" title="Direct link to Admin Group">​</a></h5>
<ul>
<li><code>Owner</code> role: full control over all resources within the group</li>
<li>Can manage IAM assignments within the group</li>
<li>Can manage resource locks</li>
<li>In Key Vaults using RBAC:<!-- -->
<ul>
<li><code>Key Vault Data Access Administrator</code> role: can manage secrets, keys and
certificates</li>
<li><code>Key Vault Administrator</code> role: can manage resource properties</li>
</ul>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="developer-group-1">Developer Group<a href="#developer-group-1" class="hash-link" aria-label="Direct link to Developer Group" title="Direct link to Developer Group">​</a></h5>
<ul>
<li><code>Contributor</code> role: can create and manage resources</li>
<li>Cannot modify IAM assignments</li>
<li>Cannot modify resource locks</li>
<li>In Key Vaults using RBAC:<!-- -->
<ul>
<li><code>Key Vault Secrets Officer</code> role: can manage secrets</li>
</ul>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="external-group-1">External Group<a href="#external-group-1" class="hash-link" aria-label="Direct link to External Group" title="Direct link to External Group">​</a></h5>
<ul>
<li><code>Reader</code> (inherited) role: can view resources and configurations</li>
<li>No modification privileges</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="shared-resources-level-access">Shared Resources-Level Access<a href="#shared-resources-level-access" class="hash-link" aria-label="Direct link to Shared Resources-Level Access" title="Direct link to Shared Resources-Level Access">​</a></h4>
<p>Some resources are inherently shared across teams due to their nature or
architectural decisions. These include (but are not limited to):</p>
<ul>
<li>Application Gateways</li>
<li>API Management</li>
<li>Public and Private DNS Zones</li>
<li>Private Endpoints</li>
<li>Other product-specific resources</li>
</ul>
<p>For shared resources, teams must request role assignments through Pull Requests
to the repository where they are defined (generally <code>&lt;product-name&gt;-infra</code>).
This process is useful to control access and management of critical resources
with big radius impact.</p>
<h2 class="anchor anchorWithStickyNavbar_YRFy" id="role-based-access-matrix">Role-Based Access Matrix<a href="#role-based-access-matrix" class="hash-link" aria-label="Direct link to Role-Based Access Matrix" title="Direct link to Role-Based Access Matrix">​</a></h2>
<p>The following roles are set up automatically by the Terraform module
<code>azure_github_environment_bootstrap</code>. Its usage is strong advised for mono
repositories. The first view is cleaner and easier to read, recommended for
developers.</p>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Simplified view</summary><div><div class="collapsibleContent_YirL"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center"><strong>Product Subscription</strong></th><th style="text-align:center"><strong>Product Private Endpoints</strong></th><th style="text-align:center"><strong>Product Private DNS Zone</strong></th><th style="text-align:center"><strong>Product NAT Gateway</strong></th><th style="text-align:center"><strong>Product APIM</strong></th><th style="text-align:center"><strong>Team Resource Groups</strong></th><th style="text-align:center"><strong>Opex Resource Group</strong></th></tr></thead><tbody><tr><td style="text-align:center"><strong>Entra ID Adm</strong></td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer - Lock manager - IAM manager</td><td style="text-align:center">Writer</td></tr><tr><td style="text-align:center"><strong>Entra ID Devs</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">Writer</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Writer - No access to Certificate and Keys</td><td style="text-align:center">Reader</td></tr><tr><td style="text-align:center"><strong>Entra ID Ext</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">Writer</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td></tr><tr><td style="text-align:center">****</td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><strong>ID Infra CI</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">List secrets</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td></tr><tr><td style="text-align:center"><strong>ID Infra CD</strong></td><td style="text-align:center">Reader - IAM Manager</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer - IAM Manager - Manage resource locks</td><td style="text-align:center">Reader - IAM Manager</td></tr><tr><td style="text-align:center"><strong>ID App CD</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Writer</td><td style="text-align:center">Reader</td></tr><tr><td style="text-align:center"><strong>ID Opex CI</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td></tr><tr><td style="text-align:center"><strong>ID Opex CD</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Reader</td><td style="text-align:center">Writer</td></tr></tbody></table></div></div></details>
<br>
<p>This view is instead recommended for cloud operators.</p>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Detailed view</summary><div><div class="collapsibleContent_YirL"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center"><strong>Product Subscription</strong></th><th style="text-align:center"><strong>Product Private Endpoints</strong></th><th style="text-align:center"><strong>Product Private DNS Zone</strong></th><th style="text-align:center"><strong>Product NAT Gateway</strong></th><th style="text-align:center"><strong>Product APIM</strong></th><th style="text-align:center"><strong>Team Resource Groups</strong></th><th style="text-align:center"><strong>Opex Resource Group</strong></th></tr></thead><tbody><tr><td style="text-align:center"><strong>Entra ID Adm</strong></td><td style="text-align:center">Contributor</td><td style="text-align:center">(inherited Contributor)</td><td style="text-align:center">(inherited Contributor)</td><td style="text-align:center">(inherited Contributor)</td><td style="text-align:center">(inherited Contributor)</td><td style="text-align:center">Owner - Key Vault Data Access Administrator - Key Vault Administrator</td><td style="text-align:center">(inherited Contributor)</td></tr><tr><td style="text-align:center"><strong>Entra ID Devs</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">Contributor - Key Vault Secrets Officer</td><td style="text-align:center">(inherited Reader)</td></tr><tr><td style="text-align:center"><strong>Entra ID Ext</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">Reader</td><td style="text-align:center">(inherited Reader)</td></tr><tr><td style="text-align:center">****</td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><strong>ID Infra CI</strong></td><td style="text-align:center">Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor</td><td style="text-align:center">(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)</td><td style="text-align:center">(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)</td><td style="text-align:center">(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)</td><td style="text-align:center">PagoPA API Management Service List Secrets</td><td style="text-align:center">Key Vault Secrets User - Key Vault Certificate User - Key Vault Crypto User - Storage Blob Data Reader - Storage Queue Data Reader - Storage Table Data Reader</td><td style="text-align:center">(inherited Reader - Reader and Data Access - PagoPA Iac Reader - DocumentDB Account Contributor)</td></tr><tr><td style="text-align:center"><strong>ID Infra CD</strong></td><td style="text-align:center">Reader - Role Based Access Control Administrator</td><td style="text-align:center">Network Contributor</td><td style="text-align:center">Private DNS Zone Contributor</td><td style="text-align:center">Network Contributor</td><td style="text-align:center">API Management Service Contributor</td><td style="text-align:center">Contributor - Key Vault Secrets Officer - Key Vault Certificates Officer - Key Vault Crypto Officer</td><td style="text-align:center">(inherited Reader - Role Based Access Control Administrator)</td></tr><tr><td style="text-align:center"><strong>ID App CD</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">(inherited Reader)</td><td style="text-align:center">Contributor</td></tr><tr><td style="text-align:center"><strong>ID Opex CI</strong></td><td style="text-align:center">Reader - Reader and Data Access</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td></tr><tr><td style="text-align:center"><strong>ID Opex CD</strong></td><td style="text-align:center">Reader</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">(inherited Reader - Reader and Data Access)</td><td style="text-align:center">Monitoring Contributor - PagoPA Opex Dashboards Contributor</td></tr></tbody></table></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="roles-explanation">Roles explanation<a href="#roles-explanation" class="hash-link" aria-label="Direct link to Roles explanation" title="Direct link to Roles explanation">​</a></h3>
<table><thead><tr><th>Role</th><th>Description</th></tr></thead><tbody><tr><td><code>Reader</code></td><td>Resource control plane read-only access</td></tr><tr><td><code>Reader and Data Access</code></td><td>Resource data plane read access. Allows writing on Storage Account using keys as authentication system</td></tr><tr><td><code>PagoPA IaC Reader</code></td><td>List keys and credentials for IaC access</td></tr><tr><td><code>DocumentDB Account Contributor</code></td><td>CosmosDB control plane access</td></tr><tr><td><code>Key Vault Data Access Administrator</code></td><td>Manage access to Azure Key Vault</td></tr><tr><td><code>Key Vault Administrator</code></td><td>Includes data plane operations on a key vault and all objects in it, including certificates, keys, and secrets</td></tr><tr><td><code>Key Vault Secrets Officer</code></td><td>Perform any action on the secrets of a key vault, except managing permissions</td></tr><tr><td><code>Role Based Access Control Administrator</code></td><td>Manage access to Azure resources by assigning roles using Azure RBAC</td></tr><tr><td><code>User Access Administrator</code></td><td>Lets you manage user access to Azure resources, including locks</td></tr><tr><td><code>Network Contributor</code></td><td>Lets you manage networks, but not access to them</td></tr><tr><td><code>Private DNS Zone Contributor</code></td><td>Lets you manage private DNS zone resources, but not the virtual networks they are linked to</td></tr><tr><td><code>API Management Service Contributor</code></td><td>Can manage the service and the APIs</td></tr><tr><td><code>Storage Blob Data Contributor</code></td><td>Read, write, and delete Azure Storage containers and blobs</td></tr><tr><td><code>Storage Queue Data Contributor</code></td><td>Read, write, and delete Azure Storage queues and queue messages</td></tr><tr><td><code>Storage Table Data Contributor</code></td><td>Allows for read, write, and delete access to Azure Storage tables and entities</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_YRFy" id="code-examples-how-to-and-common-troubleshooting">Code Examples (How-To) and Common Troubleshooting<a href="#code-examples-how-to-and-common-troubleshooting" class="hash-link" aria-label="Direct link to Code Examples (How-To) and Common Troubleshooting" title="Direct link to Code Examples (How-To) and Common Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="how-to-label-a-resource-group-as-team-owned">How to label a resource group as team-owned<a href="#how-to-label-a-resource-group-as-team-owned" class="hash-link" aria-label="Direct link to How to label a resource group as team-owned" title="Direct link to How to label a resource group as team-owned">​</a></h3>
<p>Create the resource group in <code>Repository</code> Terraform configuration of your mono
repository and pass its resource id to the <code>azure_github_environment_bootstrap</code>
module via the <code>additional_resource_group_ids</code> variable. All roles will be
automatically applied.</p>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">resource </span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic">&quot;azurerm_resource_group&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;domain_itn_01&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">name</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">location</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;location&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">tags</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> local.tags</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;repo&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-github-environment-bootstrap/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;1.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">TBD</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      azurerm_resource_group.domain_itn_01.id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-resources">Azure Resources<a href="#azure-resources" class="hash-link" aria-label="Direct link to Azure Resources" title="Direct link to Azure Resources">​</a></h3>
<p>Understand IAM and assigning the right role in the right way could be difficult.
So, this section shows most common scenarios developers may face.</p>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="notes">Notes<a href="#notes" class="hash-link" aria-label="Direct link to Notes" title="Direct link to Notes">​</a></h4>
<p>The label <code>set by the module</code> means that the role is already given by the DX
module <code>azure_github_environment_bootstrap</code> to Entra ID groups. <strong>Applications
still need a role assignment</strong> (possibly with the narrowest scope).</p>
<p>Code samples should be set next to the resource definition, unless otherwise
specified. The repository can be found in resource tags on Azure Portal.</p>
<p><code>Writer</code> role includes <code>Reader</code>, unless otherwise specified.</p>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-apim">Azure APIM<a href="#azure-apim" class="hash-link" aria-label="Direct link to Azure APIM" title="Direct link to Azure APIM">​</a></h3>
<p>If you get an error about roles while operating on APIM, please add the
<code>apim_id</code> optional variable to the <code>azure_github_environment_bootstrap</code> by
specifying the APIM instance resource Id.</p>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-cache-for-redis">Azure Cache for Redis<a href="#azure-cache-for-redis" class="hash-link" aria-label="Direct link to Azure Cache for Redis" title="Direct link to Azure Cache for Redis">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="team-owned-redis">Team-owned Redis<a href="#team-owned-redis" class="hash-link" aria-label="Direct link to Team-owned Redis" title="Direct link to Team-owned Redis">​</a></h4>
<p>Set by the module</p>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="shared-redis">Shared Redis<a href="#shared-redis" class="hash-link" aria-label="Direct link to Shared Redis" title="Direct link to Shared Redis">​</a></h4>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;azurerm_role_assignment&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">scope</span><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;redis-id&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">role_definition_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Contributor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-cosmos-db">Azure Cosmos DB<a href="#azure-cosmos-db" class="hash-link" aria-label="Direct link to Azure Cosmos DB" title="Direct link to Azure Cosmos DB">​</a></h3>
<p>In both scenarios, it is mandatory to manually set IAM roles. This approach is
recommended as keys are not secure.</p>
<p>It is also recommended to set roles at container level rather than Cosmos DB
Account, especially for applications and shared Accounts.</p>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-role-assignments/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">cosmos</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">account_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">resource_group_name</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-rg-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">role</span><span class="token plain">                 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reader&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Optionally set the database and container via optional variables <code>database</code> and
<code>collections</code>.</p></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-event-hub">Azure Event Hub<a href="#azure-event-hub" class="hash-link" aria-label="Direct link to Azure Event Hub" title="Direct link to Azure Event Hub">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="team-owned-event-hub">Team-owned Event Hub<a href="#team-owned-event-hub" class="hash-link" aria-label="Direct link to Team-owned Event Hub" title="Direct link to Team-owned Event Hub">​</a></h4>
<p>Set by the module</p>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="shared-event-hub">Shared Event Hub<a href="#shared-event-hub" class="hash-link" aria-label="Direct link to Shared Event Hub" title="Direct link to Shared Event Hub">​</a></h4>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-role-assignments/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">event_hub</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">namespace_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">resource_group_name</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-rg-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">role</span><span class="token plain">                 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reader&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Optionally set the Event Hubs via <code>event_hub_names</code> property.</p></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-key-vault">Azure Key Vault<a href="#azure-key-vault" class="hash-link" aria-label="Direct link to Azure Key Vault" title="Direct link to Azure Key Vault">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="team-owned-key-vault">Team-owned Key Vault<a href="#team-owned-key-vault" class="hash-link" aria-label="Direct link to Team-owned Key Vault" title="Direct link to Team-owned Key Vault">​</a></h4>
<p>Set by the module if using RBAC access model (recommended).</p>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Enabling RBAC access model to Key Vault</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;azurerm_key_vault&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">name</span><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">location</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;location&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">resource_group_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;resource-group&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">enable_rbac_authorization</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<p>Otherwise via Access Policies:</p>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Manage Key Vault Access Policies</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-role-assignments/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">key_vault</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">secrets</span><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;writer&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer or owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">certificates</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;writer&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer or owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">keys</span><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;writer&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer or owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="shared-key-vault">Shared Key Vault<a href="#shared-key-vault" class="hash-link" aria-label="Direct link to Shared Key Vault" title="Direct link to Shared Key Vault">​</a></h4>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-role-assignments/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">key_vault</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">secrets</span><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;writer&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer or owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">certificates</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;writer&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer or owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">keys</span><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;writer&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer or owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-nat-gateway">Azure NAT Gateway<a href="#azure-nat-gateway" class="hash-link" aria-label="Direct link to Azure NAT Gateway" title="Direct link to Azure NAT Gateway">​</a></h3>
<p>If you get an error about roles while associating a NAT Gateway to an
AppService/Function App, please add the <code>nat_gateway_resource_group_id</code> optional
variable to the <code>azure_github_environment_bootstrap</code> by specifying the NAT
Gateways&#x27; resource group Id.</p>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-notification-hub">Azure Notification Hub<a href="#azure-notification-hub" class="hash-link" aria-label="Direct link to Azure Notification Hub" title="Direct link to Azure Notification Hub">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="team-owned-notification-hub">Team-owned Notification Hub<a href="#team-owned-notification-hub" class="hash-link" aria-label="Direct link to Team-owned Notification Hub" title="Direct link to Team-owned Notification Hub">​</a></h4>
<p>Set by the module</p>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="shared-notification-hub">Shared Notification Hub<a href="#shared-notification-hub" class="hash-link" aria-label="Direct link to Shared Notification Hub" title="Direct link to Shared Notification Hub">​</a></h4>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Enable Terraform state access via Entra ID</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;azurerm_role_assignment&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">scope</span><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;notification-hub-namespace-id&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">role_definition_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Contributor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="azure-storage-account">Azure Storage Account<a href="#azure-storage-account" class="hash-link" aria-label="Direct link to Azure Storage Account" title="Direct link to Azure Storage Account">​</a></h3>
<p>It is recommended to use Entra ID authentication to access Storage Accounts,
instead of using keys. In fact, key-based access ignores IAM roles and can be
used by anyone without further authentication.</p>
<p>To set Entra ID authentication as default and disabling key access, set the
properties TBD of the Storage Account DX module.</p>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Enable Terraform state access via Entra ID</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">backend</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;azurerm&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  `use_azuread_auth` </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Enable Storage Account access via Entra ID</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">provider</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;azurerm&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">features</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">storage_use_azuread</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="blob">Blob<a href="#blob" class="hash-link" aria-label="Direct link to Blob" title="Direct link to Blob">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="team-owned-storage-account">Team-owned Storage Account<a href="#team-owned-storage-account" class="hash-link" aria-label="Direct link to Team-owned Storage Account" title="Direct link to Team-owned Storage Account">​</a></h5>
<p>Set by the module</p>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="shared-storage-account">Shared Storage Account<a href="#shared-storage-account" class="hash-link" aria-label="Direct link to Shared Storage Account" title="Direct link to Shared Storage Account">​</a></h5>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-role-assignments/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">storage_blob</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">storage_account_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">resource_group_name</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-rg-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">role</span><span class="token plain">                 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reader&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Optionally set the container name via <code>container_name</code> property.</p></div></div></details>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="terraform-storage-account">Terraform Storage Account<a href="#terraform-storage-account" class="hash-link" aria-label="Direct link to Terraform Storage Account" title="Direct link to Terraform Storage Account">​</a></h5>
<p>Set by the module</p>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="queue">Queue<a href="#queue" class="hash-link" aria-label="Direct link to Queue" title="Direct link to Queue">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="team-owned-storage-account-1">Team-owned Storage Account<a href="#team-owned-storage-account-1" class="hash-link" aria-label="Direct link to Team-owned Storage Account" title="Direct link to Team-owned Storage Account">​</a></h5>
<p>Set by the module</p>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="shared-storage-account-1">Shared Storage Account<a href="#shared-storage-account-1" class="hash-link" aria-label="Direct link to Shared Storage Account" title="Direct link to Shared Storage Account">​</a></h5>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-role-assignments/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">storage_queue</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">storage_account_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">resource_group_name</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-rg-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">role</span><span class="token plain">                 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reader&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Optionally set the container name via <code>queue_name</code> property.</p></div></div></details>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="terraform-storage-account-1">Terraform Storage Account<a href="#terraform-storage-account-1" class="hash-link" aria-label="Direct link to Terraform Storage Account" title="Direct link to Terraform Storage Account">​</a></h5>
<p>Set by the module</p>
<h4 class="anchor anchorWithStickyNavbar_YRFy" id="table">Table<a href="#table" class="hash-link" aria-label="Direct link to Table" title="Direct link to Table">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="team-owned-storage-account-2">Team-owned Storage Account<a href="#team-owned-storage-account-2" class="hash-link" aria-label="Direct link to Team-owned Storage Account" title="Direct link to Team-owned Storage Account">​</a></h5>
<p>Set by the module</p>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="shared-storage-account-2">Shared Storage Account<a href="#shared-storage-account-2" class="hash-link" aria-label="Direct link to Shared Storage Account" title="Direct link to Shared Storage Account">​</a></h5>
<details class="details_d_fS alert alert--info details_wiCQ" data-collapsed="true"><summary>Example</summary><div><div class="collapsibleContent_YirL"><div class="language-hcl codeBlockContainer_s8SY theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_JcMR"><pre tabindex="0" class="prism-code language-hcl codeBlock_xLE2 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_MviW"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">module</span><span class="token keyword type variable" style="color:rgb(189, 147, 249);font-style:italic"> &quot;&quot; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">source</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pagopa-dx/azure-role-assignments/azurerm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">version</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;~&gt;0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">principal_id</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;who-needs-access&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">storage_table</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">storage_account_name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">resource_group_name</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> &lt;st-target-rg-name&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token property">role</span><span class="token plain">                 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;reader&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># or writer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Optionally set the table name via `table_name` property.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_rC9G"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_sWaF" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_IVNQ"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_C7p9"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h5 class="anchor anchorWithStickyNavbar_YRFy" id="terraform-storage-account-2">Terraform Storage Account<a href="#terraform-storage-account-2" class="hash-link" aria-label="Direct link to Terraform Storage Account" title="Direct link to Terraform Storage Account">​</a></h5>
<p>Set by the module</p>
<h2 class="anchor anchorWithStickyNavbar_YRFy" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="role-usage-guidelines">Role Usage Guidelines<a href="#role-usage-guidelines" class="hash-link" aria-label="Direct link to Role Usage Guidelines" title="Direct link to Role Usage Guidelines">​</a></h3>
<ul>
<li>Follow least-privilege principle</li>
<li>Add a brief description in the proper field of the role assignment object when
available</li>
<li>Use admin privileges only for critical operations</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_YRFy" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations">​</a></h3>
<ul>
<li>Avoid connection strings; use managed identities where possible</li>
<li>Remove unused role assignments</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/pagopa/dx/tree/main/website/docs/infrastructure/azure/azure-iam.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_kpxt" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_kx3P"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/archive-data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Archiving Data for Decommissioned Projects</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dx/pr-preview/pr-518/docs/infrastructure/azure/iam-cross-subscription"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Implementing Azure IAM Across Subscriptions using Terraform</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_ZaAn thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#roles-and-permissions" class="table-of-contents__link toc-highlight">Roles and Permissions</a><ul><li><a href="#subscription-level-access" class="table-of-contents__link toc-highlight">Subscription-Level Access</a></li><li><a href="#resource-group-level-access" class="table-of-contents__link toc-highlight">Resource Group-Level Access</a></li></ul></li><li><a href="#role-based-access-matrix" class="table-of-contents__link toc-highlight">Role-Based Access Matrix</a><ul><li><a href="#roles-explanation" class="table-of-contents__link toc-highlight">Roles explanation</a></li></ul></li><li><a href="#code-examples-how-to-and-common-troubleshooting" class="table-of-contents__link toc-highlight">Code Examples (How-To) and Common Troubleshooting</a><ul><li><a href="#how-to-label-a-resource-group-as-team-owned" class="table-of-contents__link toc-highlight">How to label a resource group as team-owned</a></li><li><a href="#azure-resources" class="table-of-contents__link toc-highlight">Azure Resources</a></li><li><a href="#azure-apim" class="table-of-contents__link toc-highlight">Azure APIM</a></li><li><a href="#azure-cache-for-redis" class="table-of-contents__link toc-highlight">Azure Cache for Redis</a></li><li><a href="#azure-cosmos-db" class="table-of-contents__link toc-highlight">Azure Cosmos DB</a></li><li><a href="#azure-event-hub" class="table-of-contents__link toc-highlight">Azure Event Hub</a></li><li><a href="#azure-key-vault" class="table-of-contents__link toc-highlight">Azure Key Vault</a></li><li><a href="#azure-nat-gateway" class="table-of-contents__link toc-highlight">Azure NAT Gateway</a></li><li><a href="#azure-notification-hub" class="table-of-contents__link toc-highlight">Azure Notification Hub</a></li><li><a href="#azure-storage-account" class="table-of-contents__link toc-highlight">Azure Storage Account</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a><ul><li><a href="#role-usage-guidelines" class="table-of-contents__link toc-highlight">Role Usage Guidelines</a></li><li><a href="#security-considerations" class="table-of-contents__link toc-highlight">Security Considerations</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/dx/pr-preview/pr-518/docs/">Start here</a></li></ul></div><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/dx/pr-preview/pr-518/blog/">Read announcements</a></li></ul></div></div></div></footer></div>
</body>
</html>