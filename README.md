<div align="center">

<img src="./assets/pagopa-logo.jpg" width="100" alt="PagoPA icon">

# DevEx Initiative: Transforming the Development Experience at PagoPA

![Static Badge](https://img.shields.io/badge/getting%20started-blue?logo=docusaurus&label=doc&cacheSeconds=5000&link=https%3A%2F%2Fpagopa.github.io%2Fdx%2Fdocs%2F)
[![Shield: Doc](https://img.shields.io/badge/contributions-welcome-red)](#Contributing)
![Static Badge](https://img.shields.io/badge/latest%20news-blue?logo=docusaurus&label=blog&cacheSeconds=5000&link=https%3A%2F%2Fpagopa.github.io%2Fdx%2Fblog%2F)

Imagine being able to release the first API for a new digital service into production in minutes instead of weeks, having fewer decisions to make, less code to interpret and maintain, onboarding new team members with zero downtime: this is the goal we set for ourselves with the Developer Experience (DevEx) initiative.

At the heart of the Engineering Area, a group of Senior, Cloud, and Staff Engineers has decided to tackle the daily challenges that slow down our work. We're here to break down barriers, simplify processes, and make software development smoother and more rewarding for everyone.

**Terraform Download Stats**

![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-role-assignments/azurerm?label=azure-role-assignments&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-role-assignments%2Fazurerm%2Flatest&logo=terraform)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-function-app/azurerm?logo=terraform&label=azure-function-app&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-function-app%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/github-selfhosted-runner-on-container-app-jobs/azurerm?logo=terraform&label=github-selfhosted-runner-on-container-app-jobs&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fgithub-selfhosted-runner-on-container-app-jobs%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-app-service-plan-autoscaler/azurerm?logo=terraform&label=azure-app-service-plan-autoscaler&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-app-service-plan-autoscaler%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-cosmos-account/azurerm?logo=terraform&label=azure-cosmos-account&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-cosmos-account%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-app-service/azurerm?logo=terraform&label=azure-app-service&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-app-service%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-api-management/azurerm?logo=terraform&label=azure-api-management&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-api-management%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-storage-account/azurerm?logo=terraform&label=azure-storage-account&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-storage-account%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-event-hub/azurerm?logo=terraform&label=azure-event-hub&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-event-hub%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-federated-identity-with-github/azurerm?logo=terraform&label=azure-federated-identity-with-github&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-federated-identity-with-github%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-container-app-environment/azurerm?logo=terraform&label=azure-container-app-environment&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-container-app-environment%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-github-environment-bootstrap/azurerm?logo=terraform&label=azure-github-environment-bootstrap&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-github-environment-bootstrap%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-container-app/azurerm?logo=terraform&label=azure-container-app&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-container-app%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-cdn/azurerm?logo=terraform&label=azure-cdn&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-cdn%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-postgres-server/azurerm?logo=terraform&label=azure-postgres-server&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-postgres-server%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-function-app-exposed/azurerm?logo=terraform&label=azure-function-app-exposed&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-function-app-exposed%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-app-service-exposed/azurerm?logo=terraform&label=azure-app-service-exposed&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-app-service-exposed%2Fazurerm%2Flatest)
![Terraform Module Downloads](https://img.shields.io/terraform/module/dm/pagopa-dx/azure-core-infra/azurerm?logo=terraform&label=azure-core-infra&cacheSeconds=5000&link=https%3A%2F%2Fregistry.terraform.io%2Fmodules%2Fpagopa-dx%2Fazure-core-infra%2Fazurerm%2Flatest)

</div>

## NPM packages

This project requires specific versions of the following tools. To make sure your development setup matches with production follow the recommended installation methods.

- **Node.js**

  Use [nodenv](https://github.com/nodenv/nodenv) to install the [required version](.node-version) of `Node.js`.

  ```sh
  nodenv install
  node --version
  ```

- **Yarn**

  Yarn must be installed using [Corepack](https://yarnpkg.com/getting-started/install), included by default in `Node.js`.

  ```sh
  corepack enable
  yarn --version
  ```

- **Terraform**

  Use [tfenv](https://github.com/tfutils/tfenv) to install the [required version](.terraform-version) of `terraform`.

  ```sh
  tfenv install
  terraform version
  ```

- **pre-commit**

  [Follow the official documentation](https://pre-commit.com/) to install `pre-commit` in your machine.

  ```sh
  pre-commit install
  ```

## Tasks

Tasks are defined in the `turbo.json` and `package.json` files. To execute a task, just run the command at the project root:

```sh
yarn <cmd>
```

`Turborepo` will execute the task for all the workspaces that declare the same command in their `package.json` file; it also applies caching policies to the command according to the rules defined in `turbo.json`.

To define a new task:

- add the definition to `turbo.json` under `pipeline`;
- add a script with the same name in `package.json` as `turbo <cmd name>`.

To see the defined task run `yarn run`

## Dependencies

> [!IMPORTANT]  
> This project uses Yarn Plug'n'Play as installation strategy for dependencies. [Check out](https://yarnpkg.com/features/pnp) the official Yarn documentation to lean about pnp and its difference from the classic `node_modules` approach.

```sh
# install all dependencies for the project
yarn

# install a dependency to a workspace
#   (workspace name is the name in the package.json file)
yarn workspace <workspace name> add <package name>
yarn workspace <workspace name> add -D <package name>

# install a dependency for the monorepo
#   (ideally a shared dev dependency)
yarn add -D <package name>
```

To add a dependency to a local workspace, manually edit the target workspace's `package.json` file adding the dependency as

```json
"dependencies": {
    "my-dependency-workspace": "workspace:*"
}
```

### Yarn SDKS (.yarn/sdks)

Smart IDEs (such as VSCode or IntelliJ) require special configuration for TypeScript to work when using Plug'n'Play installs. That configuration is generated automatically by `yarn` (via `yarn dlx @yarnpkg/sdks vscode vim [other-editor...]`) and commited to `.yarn/sdks`.
