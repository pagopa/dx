---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "dx_available_subnet_cidr Resource - terraform-provider-dx"
subcategory: ""
description: |-
  Finds an available CIDR block for a new subnet within a specified AWS VPC.
---

# available_subnet_cidr Resource

Finds an available CIDR block for a new subnet within a specified AWS VPC.

## Example Usage

```hcl
resource "dx_available_subnet_cidr" "next_cidr" {
  vpc_id        = aws_vpc.example.id
  prefix_length = 24  # For a /24 subnet
}

resource "aws_subnet" "new_subnet" {
  vpc_id            = aws_vpc.example.id
  cidr_block        = dx_available_subnet_cidr.next_cidr.cidr_block
  availability_zone = "eu-west-1a"

  tags = {
    Name = "example-subnet"
  }
}
```

When creating multiple subnets, it is necessary to use `depends_on` to prevent CIDR block overlaps:

```hcl
resource "dx_available_subnet_cidr" "next_cidr_1" {
  vpc_id        = aws_vpc.this.id
  prefix_length = 24
}

resource "aws_subnet" "new_subnet_1" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = dx_available_subnet_cidr.next_cidr_1.cidr_block
  availability_zone = "eu-west-1a"

  tags = {
    Name = "my-new-subnet-1"
  }
}

resource "dx_available_subnet_cidr" "next_cidr_2" {
  vpc_id        = aws_vpc.this.id
  prefix_length = 29

  # Ensures the first CIDR block is allocated before finding the next one
  depends_on = [
    aws_subnet.new_subnet_1
  ]
}

resource "aws_subnet" "new_subnet_2" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = dx_available_subnet_cidr.next_cidr_2.cidr_block
  availability_zone = "eu-west-1b"

  tags = {
    Name = "my-new-subnet-2"
  }
}
```

<!-- schema generated by tfplugindocs -->

## Schema

### Required

- `prefix_length` (Number) The desired prefix length for the new subnet CIDR (e.g., 24 for a /24 subnet). Must be larger than the VPC prefix and smaller or equal to 28.
- `vpc_id` (String) The AWS VPC ID where the subnet will be created. Must be in the format `vpc-xxxxxxxxx`.

### Read-Only

- `id` - A unique identifier for the resource, combining the VPC ID, prefix length, and allocated CIDR.

- `cidr_block` (String) The calculated available CIDR block.

## Import

This resource cannot be imported as it is a virtual resource that doesn't correspond to an actual AWS resource.

## Notes

- This is a virtual resource that doesn't create an actual resource in AWS. It only calculates and reserves a CIDR block in your Terraform state.
- The allocated CIDR is determined by analyzing the existing subnets in the VPC and finding an available block that doesn't overlap.
- Changing either `vpc_id` or `prefix_length` after creation requires recreating the resource.
- The AWS provider must be configured with appropriate credentials and permissions to describe VPCs and subnets.
